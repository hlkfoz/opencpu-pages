--- 
layout: page 
title: "API Docs" 
---

<div class="row">
  <div class="col-xs-12 col-sm-8 col-sm-offset-2">
	  <div class="alert alert-danger">
	    <strong>Heads Up!</strong> (last updated August 18) The OpenCPU documentation and demo servers are in the process of being updated to the new
	    OpenCPU 1.0! A copy of the old site is still available <a href="http://public.opencpu.org/legacy/">here</a>.
	  </div>  
  </div>
</div>


<div class="row">
	<div class="col-md-3">
		<div id="docmenu" class="bs-sidebar hidden-print" data-spy="affix" data-offset-top="240" role="complementary">
			<ul class="nav bs-sidenav">
				<li><a href="#api-overview">Overview</a>
					<ul class="nav">
						<li><a href="#api-web">Web API</a></li>
						<li><a href="#api-functionality">Functionality</a></li>
						<li><a href="#api-state">Server State</a></li>
						<li><a href="#api-static">Static Content</a></li>
						<li><a href="#api-apps">Apps</a></li>
					</ul></li>	
					
        <li><a href="#api-http">HTTP</a>
          <ul class="nav">
            <li><a href="#api-methods">Methods</a></li>
            <li><a href="#api-statuscodes">Status Codes</a></li>
            <li><a href="#api-contenttypes">Content-types</a></li>
          </ul></li>    		
          				
				<li><a href="#api-endpoints">Endpoints</a>
					<ul class="nav">
						<li><a href="#api-libraries">Libraries</a></li>
						<li><a href="#api-packages">Packages</a></li>
						<li><a href="#api-objects">Objects</a></li>
						<li><a href="#api-manuals">Manuals</a></li>
						<li><a href="#api-sessions">Sessions</a></li>
					</ul></li>

        <li><a href="#tooltips">Output Formats</a>
          <ul class="nav">
            <li><a href="#tooltips-examples">Examples</a></li>
            <li><a href="#tooltips-usage">Usage</a></li>
          </ul></li>					

        <li><a href="#tooltips">Argument Formats</a>
          <ul class="nav">
            <li><a href="#tooltips-examples">Examples</a></li>
            <li><a href="#tooltips-usage">Usage</a></li>
          </ul></li>      
					
        <li><a href="#tabs">JSON I/O</a>
          <ul class="nav">
            <li><a href="#tabs-examples">JSON input</a></li>
            <li><a href="#tabs-usage">JSON output</a></li>
          </ul></li>					
			</ul>
		</div>
	</div>
	<div class="col-md-9" role="main">

    <!-- SECTION Overview -->	
	  <div class="page-header">
      <h1 id="api-overview">API Overview</h1>
    </div>
    
    <p>
    The OpenCPU server exposes a web API interfacing R, Latex and Pandoc. 
    The API allows clients to read, write and call functions and objects, as well as run scripts reproducible documents (Sweave, knitr, etc).
    This is used for example to integrate statistical functionality into systems, 
    share and execute scripts or reports on centralized servers, or build statistical "apps".  
    </p>
    
    <h2 id="api-web">A web API</h2>  
    
    
    
    <h2 id="api-functionality">High Level Functionality</h2> 
    <h2 id="api-state">On Server State</h2> 
    
    <p>OpenCPU is HTTP and therefore stateless. There is also no authentication or http sessions. 
    Each request is independent of the previous one. In order to simulate state, we can chain function calls <code>f(g(x), h(y))</code>
    passing the output ID of a previous call as an argument to a subsequent call. See the section below on arguments for more information on function chaining.  

    
    <h2 id="api-static">Serving Static Content</h2> 
    <h2 id="api-apps">Developing Apps</h2> 
    

    <!-- SECTION HTTP --> 
    <div class="page-header">
      <h1 id="api-http">HTTP Implementation</h1> 
    </div>
    
    <h2 id="api-methods">HTTP Methods</h2>
    
    <table class="table table-hover">
      <thead>
        <tr>
          <th>Method</th>
          <th>Target</th>
          <th>Action</th>
          <th>Arguments</th>          
          <th>Example</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><code>GET</code></td>
          <td>object</td>
          <td>read object</td>
          <td>control output format</td>          
          <td><code>GET /ocpu/library/datasets/R/mtcars/json?digits=0</code></td>
        </tr>
        <tr>
          <td><code>GET</code></td>
          <td>file</td>
          <td>read file</td>
          <td>-</td>
          <td><code>GET /ocpu/library/MASS/NEWS</code> <br /> <code>GET /ocpu/library/MASS/scripts/</code></td>
        </tr>  
        <tr>
          <td><code>POST</code></td>
          <td>object</td>
          <td>call function</td>
          <td>function arguments</td>
          <td><code>POST /ocpu/library/stats/R/rnorm</code></td>
        </tr> 
        <tr>
          <td><code>POST</code></td>
          <td>file</td>
          <td>run script</td>
          <td>control interpreter </td>
          <td><code>POST /ocpu/library/MASS/scripts/ch01.R</code> <br /><code>POST /ocpu/library/knitr/examples/knitr-minimal.Rmd</code></td>
        </tr>                         
      </tbody>
    </table>
    
    <h2 id="api-statuscodes">HTTP Status Codes</h2> 
    
    <table class="table table-hover">
      <thead>
        <tr>
          <th>HTTP Code</th>
          <th>When</th>
          <th>Returns</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><code>200 OK</code></td>
          <td>On successful GET request</td>
          <td>Resource content</td>
        </tr>
         <tr>
          <td><code>201 Created</code></td>
          <td>On successful POST request</td>
          <td>Output location</td>
        </tr>
        <tr>
          <td><code>302 Found</code></td>
          <td>Redirect</td>
          <td>Redirect Location</td>
        </tr>
        <tr>
          <td><code>400 Bad Request</code></td>
          <td>R raised an error.</td>
          <td>Error message in <code>text/plain</code></td>
        </tr>  
        <tr>
          <td><code>502 Bad Gateway</code></td>
          <td>Nginx (opencpu-cache) can't connect to OpenCPU server.</td>
          <td>(admin needs to look in error logs)</td>
        </tr>   
        <tr>
          <td><code>503 Bad Request</code></td>
          <td>Serious problem with the server</td>
          <td>(admin needs to look in error logs)</td>
        </tr>                                                    
      </tbody>
    </table>
         
    
    <!-- SECTION Endpoints --> 
    
    <h2 id="api-root">API root</h2>
    <p>The root of the OpenCPU API is dynamic. In the cloud server it defaults to <code>/ocpu/</code>, however system administrators are free to change this.
    Clients should make the OpenCPU server address and root path configurable. In the examples below we assume the default <code>/ocpu/</code>.</p>

    <h2 id="api-libraries">Libraries</h2> 
    
    <table class="table table-hover">
      <thead>
        <tr>
          <th>Path</th>
          <th>What</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><code>/ocpu/library/:pkgname/</code></td>
          <td>Interfaces to Package API for a package installed in one of the global libraries on the server.</td>
        </tr>
        <tr>
          <td><code>/ocpu/user/:username/:pkgname/</code></td>
          <td>Interfaces to Package API for a package installed in the home library of user <code>username</code>.</td>
        </tr>   
        <tr>
          <td><code>/ocpu/cran/:pkgname/</code></td>
          <td>Interfaces to Package API for a package <code>pkgname</code> that is <i>current</i> on CRAN.</td>
        </tr>   
        <tr>
          <td><code>/ocpu/bioc/:pkgname/</code></td>
          <td>Interfaces to Package API for a package <code>pkgname</code> that is <i>current</i> on BioConductor.</td>
        </tr>  
        <tr>
          <td><code>/ocpu/github/:gituser/:pkgname/</code></td>
          <td>Interfaces to Package API for a package <code>pkgname</code> that is <i>current</i> on the identically named repository from github user <code>gituser</code>.</td>
        </tr>
        <tr>
          <td><code>/ocpu/gist/:gituser/:path/</code></td>
          <td>Interfaces to Files API for file <code>path</code> as exists in the gist repository from github user <code>gituser</code>.</td>
        </tr>  
        <tr>
          <td><code>/ocpu/tmp/:sessionid/</code></td>
          <td>Interfaces to session (output) from session <code>sessionid</code></td>
        </tr>                                                                                             
      </tbody>
    </table>    
    
        
    <h2 id="api-packages">The Package API</h2> 
    
    Any of the libraries above that supports the <code>/:package/</code> API can call the following endpoints:
    
    <table class="table table-hover">
      <thead>
        <tr>
          <th>Path</th>
          <th>What</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><code>../:pkgname/</code></td>
          <td>Show information about this package.</td>
        </tr>      
        <tr>
          <td><code>../:pkgname/R</code></td>
          <td>Interfaces to the R API for R objects exported by this package.</td>
        </tr>
        <tr>
          <td><code>../:pkgname/man/</code></td>
          <td>Lists manuals (help pages) available in this package.</td>
        </tr>   
        <tr>
          <td><code>../:pkgname/man/:topic/:manformat</code></td>
          <td>Get help page about <code>topic</code> in output format <code>manformat</code>. Manual format must be one of <code>text</code>, <code>html</code>, <code>pdf</code></td>
        </tr> 
        <tr>
          <td><code>../:pkgname/:path</code></td>
          <td>For anything else, interfaces to the Files API for file <code>path</code> in the package installation directory.</td>
        </tr>                                                                                                     
      </tbody>
    </table>        
    
    <h2 id="api-objects">Objects</h2>    
    <h2 id="api-manuals">Manuals</h2>    
    <h2 id="api-sessions">Sessions</h2>   
 
    
    

	</div>
</div>

<script>
$(function(){
  $('body').scrollspy({ target: '#docmenu' })
});
</script>
